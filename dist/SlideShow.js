var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var React=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _recyclerlistview=require("recyclerlistview");var _CustomBaseScrollView=_interopRequireDefault(require("./CustomBaseScrollView"));var _DefaultViewPageIndicator=_interopRequireDefault(require("./DefaultViewPageIndicator"));var _useDataState3=_interopRequireDefault(require("./hooks/useDataState"));var _usePlayState3=_interopRequireDefault(require("./hooks/usePlayState"));var _this=this,_jsxFileName="/Users/300067164/Desktop/TestAtul/InfiniteScrollSlideShow/src/SlideShow.tsx";var itemWidth;var SlideShow=function SlideShow(_ref){var initialIndex=_ref.initialIndex,duration=_ref.duration,items=_ref.items,rowRenderer=_ref.rowRenderer,multiplier=_ref.multiplier,style=_ref.style,indicatorStyle=_ref.indicatorStyle,autoScroll=_ref.autoScroll;var recyclerList=(0,React.useRef)(null);var intialialScrollIndex=multiplier/2*items.length+initialIndex;var _useState=(0,React.useState)(intialialScrollIndex),_useState2=(0,_slicedToArray2.default)(_useState,2),currentIndexFake=_useState2[0],setCurrentIndexFake=_useState2[1];var _usePlayState=(0,_usePlayState3.default)(autoScroll),_usePlayState2=(0,_slicedToArray2.default)(_usePlayState,2),isPlaying=_usePlayState2[0],setIsPlaying=_usePlayState2[1];var _useDataState=(0,_useDataState3.default)(items,multiplier,style),_useDataState2=(0,_slicedToArray2.default)(_useDataState,2),_dataSource=_useDataState2[0],_layoutProvider=_useDataState2[1];(0,React.useEffect)(function(){if(autoScroll&&isPlaying){var timerId=setTimeout(function(){var updatedFakeIndex=(currentIndexFake+1)%(multiplier*items.length+1);recyclerList.current.scrollToIndex(updatedFakeIndex,true);},3000);return function(){return clearTimeout(timerId);};}},[currentIndexFake,isPlaying,autoScroll]);var scrollValue=new _reactNative.Animated.Value(0);var scrollToIndex=function scrollToIndex(index,animation){recyclerList.current.scrollToIndex(index,animation);};var onVisibleIndicesChanged=function onVisibleIndicesChanged(item){if(item.length===1){if(item[0]===0||item[0]===multiplier*items.length){var centerIndex=multiplier/2*items.length;scrollToIndex(centerIndex,false);}else{setCurrentIndexFake(item[0]);}}};var setScrollValue=function setScrollValue(value){value=value%items.length;if(value<0)value=0;if(value>items.length-1)value=currentIndexFake%items.length===0?0:items.length-1;scrollValue.setValue(value);};var onSCroll=function onSCroll(_ref2){var x=_ref2.nativeEvent.contentOffset.x;setScrollValue(x/itemWidth);};var onItemLayout=function onItemLayout(_ref3){var width=_ref3.nativeEvent.layout.width;itemWidth=width;};var onScrollAnimationEnd=function onScrollAnimationEnd(){setIsPlaying(true);};var onScrollBeginDrag=function onScrollBeginDrag(){setIsPlaying(false);};return React.createElement(_reactNative.View,{style:style,__self:_this,__source:{fileName:_jsxFileName,lineNumber:104,columnNumber:9}},_layoutProvider&&_dataSource&&React.createElement(_recyclerlistview.RecyclerListView,{initialRenderIndex:intialialScrollIndex,onLayout:onItemLayout,onScroll:onSCroll,ref:recyclerList,isHorizontal:true,onScrollEndDrag:onScrollAnimationEnd,onScrollBeginDrag:onScrollBeginDrag,externalScrollView:_CustomBaseScrollView.default,dataProvider:_dataSource,layoutProvider:_layoutProvider,rowRenderer:rowRenderer,onVisibleIndicesChanged:onVisibleIndicesChanged,__self:_this,__source:{fileName:_jsxFileName,lineNumber:105,columnNumber:48}}),React.createElement(_reactNative.View,{style:indicatorStyle,__self:_this,__source:{fileName:_jsxFileName,lineNumber:119,columnNumber:13}},React.createElement(_DefaultViewPageIndicator.default,{activePage:0,pageCount:items.length,scrollOffset:0,scrollValue:scrollValue,__self:_this,__source:{fileName:_jsxFileName,lineNumber:120,columnNumber:17}})));};SlideShow.defaultProps={initialIndex:0,duration:3000,multiplier:2,autoScroll:true,style:{width:_reactNative.Dimensions.get('screen').width,height:_reactNative.Dimensions.get('screen').height},indicatorStyle:{alignItems:'center',position:'absolute',bottom:10,left:0,right:0}};var _default=SlideShow;exports.default=_default;